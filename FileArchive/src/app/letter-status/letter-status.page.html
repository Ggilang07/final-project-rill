<ion-header [translucent]="true">
  <ion-toolbar color="primary">
    <ion-title>Status Pengajuan Surat</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <div class="search-container">
    <div class="search-wrapper">
      <ion-searchbar
        placeholder="Cari..."
        [(ngModel)]="searchTerm"
        (ionInput)="filterRequests($event)"
        (ionClear)="clearSearch()"
        show-clear-button="focus"
      >
      </ion-searchbar>
    </div>

    <div class="add-button-wrapper">
      <ion-button fill="clear" class="add-button" (click)="buatSurat()">
        <span class="custom-add-icon" slot="icon-only">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24">
            <path fill="none" stroke="currentColor" stroke-dasharray="56" stroke-dashoffset="56" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 4h14l-5 6.5v9.5l-4 -4v-5.5Z">
              <animate fill="freeze" attributeName="stroke-dashoffset" dur="0.6s" values="56;0"/>
            </path>
          </svg>
        </span>
      </ion-button>
    </div>
  </div>

  <div class="table-container">
    <!-- Header Table -->
    <div class="table-header">
      <div class="header-cell nomor-tanggal">Nomor Surat</div>
      <div class="header-cell jenis-surat">Jenis Surat</div>
      <div class="header-cell status">Status</div>
    </div>

    <!-- Table Rows -->
    <div class="table-row" *ngIf="getFilteredRequests().length === 0">
      <div class="no-data">
        <ion-text color="medium">
          <p>Tidak ada data yang ditemukan</p>
        </ion-text>
      </div>
    </div>

    <div class="table-row" 
         *ngFor="let request of getFilteredRequests()" 
         (click)="goToDetail(request)"
         style="cursor:pointer;">
      <div class="row-cell nomor-tanggal">
        <div class="nomor-surat">{{ request.letter_number }}</div>
        <div class="tanggal-surat">
          {{ request.created_at | date:'d MMMM y':'':'id' }}
        </div>
      </div>

      <div class="row-cell jenis-surat">{{ formatCategory(request.category) }}</div>

      <div class="row-cell status">
        <ion-icon
          [name]="getStatusIcon(request.status)"
          [class]="'status-icon ' + request.status"
        >
        </ion-icon>
      </div>
    </div>
  </div>
</ion-content>
